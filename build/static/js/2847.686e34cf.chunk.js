"use strict";(self.webpackChunkbkoz=self.webpackChunkbkoz||[]).push([[2847,9188],{9188:function(e,t,a){a.r(t),a.d(t,{decodeGIF:function(){return C},drawGif:function(){return B},getGIFLoopAmount:function(){return I},loadGifImage:function(){return D}});var r=a(4165),n=a(7762),i=a(5861),o=[0,4,2,1],s=[8,8,4,2],c=a(5671),l=a(3144),u=function(){function e(t){(0,c.Z)(this,e),this.pos=0,this.data=new Uint8ClampedArray(t)}return(0,l.Z)(e,[{key:"getString",value:function(e){var t=this.data.slice(this.pos,this.pos+e);return this.pos+=t.length,t.reduce((function(e,t){return e+String.fromCharCode(t)}),"")}},{key:"nextByte",value:function(){return this.data[this.pos++]}},{key:"nextTwoBytes",value:function(){return this.pos+=2,this.data[this.pos-2]+(this.data[this.pos-1]<<8)}},{key:"readSubBlocks",value:function(){var e="",t=0;do{for(var a=t=this.data[this.pos++];--a>=0;e+=String.fromCharCode(this.data[this.pos++]));}while(0!==t);return e}},{key:"readSubBlocksBin",value:function(){for(var e=this.data[this.pos],t=0,a=0;0!==e;a+=e+1,e=this.data[this.pos+a])t+=e;var r=new Uint8Array(t);e=this.data[this.pos++];for(var n=0;0!==e;e=this.data[this.pos++])for(var i=e;--i>=0;r[n++]=this.data[this.pos++]);return r}},{key:"skipSubBlocks",value:function(){for(;0!==this.data[this.pos];this.pos+=this.data[this.pos]+1);this.pos++}}]),e}(),h={x:0,y:0},f=0,g=.5,p=0,d=0,m=0;function x(e,t){for(var a=[],r=0;r<t;r++)a.push({r:e.data[e.pos],g:e.data[e.pos+1],b:e.data[e.pos+2]}),e.pos+=3;return a}function w(e,t,a,r){switch(e.nextByte()){case 249:var n=t.frames[a(!1)];e.pos++;var i=e.nextByte();n.GCreserved=(224&i)>>>5,n.disposalMethod=(28&i)>>>2,n.userInputDelayFlag=2===(2&i);var o=1===(1&i);n.delayTime=10*e.nextTwoBytes();var s=e.nextByte();o&&r(s),e.pos++;break;case 255:e.pos++;var c={identifier:e.getString(8),authenticationCode:e.getString(3),data:e.readSubBlocksBin()};t.applicationExtensions.push(c);break;case 254:t.comments.push([a(!1),e.readSubBlocks()]);break;case 1:if(0===t.globalColorTable.length)throw new EvalError("plain text extension without global color table");e.pos++,t.frames[a(!1)].plainTextData={left:e.nextTwoBytes(),top:e.nextTwoBytes(),width:e.nextTwoBytes(),height:e.nextTwoBytes(),charSize:{width:e.nextTwoBytes(),height:e.nextTwoBytes()},foregroundColor:e.nextByte(),backgroundColor:e.nextByte(),text:e.readSubBlocks()};break;default:e.skipSubBlocks()}}function b(e,t,a,r,n,i){return v.apply(this,arguments)}function v(){return(v=(0,i.Z)((0,r.Z)().mark((function e(t,a,i,c,l,u){var h,f,g,p,d,m,w,b,v,y,k,I,C,T,B,D,Z,S,E,F,_,A,R,G,L,z,M,O,N,U,P,K,Q,W,j,q,H,J,V,X,Y,$,ee,te,ae;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((h=a.frames[c(!0)]).left=t.nextTwoBytes(),h.top=t.nextTwoBytes(),h.width=t.nextTwoBytes(),h.height=t.nextTwoBytes(),f=t.nextByte(),g=128===(128&f),p=64===(64&f),h.sortFlag=32===(32&f),h.reserved=(24&f)>>>3,d=1<<1+(7&f),g&&(h.localColorTable=x(t,d)),m=function(e){var t=(g?h.localColorTable:a.globalColorTable)[e],r=t.r,n=t.g,o=t.b;return e!==l(null)?{r:r,g:n,b:o,a:255}:{r:r,g:n,b:o,a:i?~~((r+n+o)/3):0}},null!=(w=function(){try{return new ImageData(h.width,h.height,{colorSpace:"srgb"})}catch(e){if(e instanceof DOMException&&"IndexSizeError"===e.name)return null;throw e}}())){e.next=14;break}throw new EvalError("GIF frame size is to large");case 14:if(b=t.nextByte(),v=t.readSubBlocksBin(),y=1<<b,k=function(e,t){var a=e>>>3,r=7&e;return(v[a]+(v[a+1]<<8)+(v[a+2]<<16)&(1<<t)-1<<r)>>>r},!p){e.next=24;break}for(I=0,C=b+1,T=0,B=[[0]],D=0;D<4;D++){if(o[D]<h.height)for(Z=0,S=0,E=!1;!E;){if(F=I,I=k(T,C),T+=C+1,I===y)for(C=b+1,B.length=y+2,_=0;_<B.length;_++)B[_]=_<y?[_]:[];else{I>=B.length?B.push(B[F].concat(B[F][0])):F!==y&&B.push(B[F].concat(B[I][0])),A=(0,n.Z)(B[I]);try{for(A.s();!(R=A.n()).done;)G=R.value,L=m(G),z=L.r,M=L.g,O=L.b,N=L.a,w.data.set([z,M,O,N],o[D]*h.width+s[D]*S+Z%(4*h.width)),Z+=4}catch(r){A.e(r)}finally{A.f()}B.length===1<<C&&C<12&&C++}Z===4*h.width*(S+1)&&(S++,o[D]+s[D]*S>=h.height&&(E=!0))}null===u||void 0===u||u(t.pos/(t.data.length-1),c(!1)+1,w,{x:h.left,y:h.top},{width:a.width,height:a.height})}return h.image=w,e.next=21,createImageBitmap(w);case 21:h.bitmap=e.sent,e.next=50;break;case 24:U=0,P=b+1,K=0,Q=-4,W=!1,j=[[0]];case 26:if(W){e.next=45;break}if(q=U,U=k(K,P),K+=P,U!==y){e.next=36;break}for(P=b+1,j.length=y+2,H=0;H<j.length;H++)j[H]=H<y?[H]:[];e.next=43;break;case 36:if(U!==y+1){e.next=39;break}return W=!0,e.abrupt("break",45);case 39:U>=j.length?j.push(j[q].concat(j[q][0])):q!==y&&j.push(j[q].concat(j[U][0])),J=(0,n.Z)(j[U]);try{for(J.s();!(V=J.n()).done;)X=V.value,Y=m(X),$=Y.r,ee=Y.g,te=Y.b,ae=Y.a,w.data.set([$,ee,te,ae],Q+=4)}catch(r){J.e(r)}finally{J.f()}j.length>=1<<P&&P<12&&P++;case 43:e.next=26;break;case 45:return h.image=w,e.next=48,createImageBitmap(w);case 48:h.bitmap=e.sent,null===u||void 0===u||u((t.pos+1)/t.data.length,c(!1)+1,h.image,{x:h.left,y:h.top},{width:a.width,height:a.height});case 50:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,t,a,r,n,i){return k.apply(this,arguments)}function k(){return(k=(0,i.Z)((0,r.Z)().mark((function e(t,a,n,i,o,s){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.nextByte(),e.next=59===e.t0?3:44===e.t0?4:33===e.t0?7:9;break;case 3:return e.abrupt("return",!0);case 4:return e.next=6,b(t,a,n,i,o,s);case 6:return e.abrupt("break",10);case 7:return w(t,a,i,o),e.abrupt("break",10);case 9:throw new EvalError("undefined block found");case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){var t,a=(0,n.Z)(e.applicationExtensions);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(r.identifier+r.authenticationCode==="NETSCAPE2.0")return r.data[1]+(r.data[2]<<8)}}catch(i){a.e(i)}finally{a.f()}return NaN}function C(e,t,a){return T.apply(this,arguments)}function T(){return(T=(0,i.Z)((0,r.Z)().mark((function e(t,a,i){var o,s,c,l,h,f,g,p,d,m,w,b,v,k,I,C,T,B,D,Z,S,E;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i||(i=!1),e.next=3,fetch(t);case 3:if((o=e.sent).ok||404!==o.status){e.next=6;break}throw new EvalError("file not found");case 6:return e.next=8,o.arrayBuffer();case 8:if(s=e.sent,c={width:0,height:0,totalTime:0,colorRes:0,pixelAspectRatio:0,frames:[],sortFlag:!1,globalColorTable:[],backgroundImage:new ImageData(1,1,{colorSpace:"srgb"}),comments:[],applicationExtensions:[]},"GIF89a"===(l=new u(new Uint8ClampedArray(s))).getString(6)){e.next=12;break}throw new Error("not a supported GIF file");case 12:if(c.width=l.nextTwoBytes(),c.height=l.nextTwoBytes(),h=l.nextByte(),f=128===(128&h),c.colorRes=(112&h)>>>4,c.sortFlag=8===(8&h),g=1<<1+(7&h),p=l.nextByte(),c.pixelAspectRatio=l.nextByte(),0!==c.pixelAspectRatio&&(c.pixelAspectRatio=(c.pixelAspectRatio+15)/64),f&&(c.globalColorTable=x(l,g)),null!=(d=function(){try{return new ImageData(c.width,c.height,{colorSpace:"srgb"})}catch(e){if(e instanceof DOMException&&"IndexSizeError"===e.name)return null;throw e}}())){e.next=24;break}throw new Error("GIF frame size is to large");case 24:for(m=c.globalColorTable[p],w=m.r,b=m.g,v=m.b,d.data.set(f?[w,b,v,255]:[0,0,0,0]),k=4;k<d.data.length;k*=2)d.data.copyWithin(k,0,k);c.backgroundImage=d,I=-1,C=!0,T=-1,B=function(e){return e&&(C=!0),I},D=function(e){return null!=e&&(T=e),T},e.prev=31;case 32:C&&(c.frames.push({left:0,top:0,width:0,height:0,disposalMethod:0,image:new ImageData(1,1,{colorSpace:"srgb"}),plainTextData:null,userInputDelayFlag:!1,delayTime:0,sortFlag:!1,localColorTable:[],reserved:0,GCreserved:0}),I++,T=-1,C=!1);case 33:return e.next=35,y(l,c,i,B,D,a);case 35:if(!e.sent){e.next=32;break}case 36:c.frames.length--,Z=(0,n.Z)(c.frames),e.prev=38,Z.s();case 40:if((S=Z.n()).done){e.next=48;break}if(!(E=S.value).userInputDelayFlag||0!==E.delayTime){e.next=45;break}return c.totalTime=1/0,e.abrupt("break",48);case 45:c.totalTime+=E.delayTime;case 46:e.next=40;break;case 48:e.next=53;break;case 50:e.prev=50,e.t0=e.catch(38),Z.e(e.t0);case 53:return e.prev=53,Z.f(),e.finish(53);case 56:return e.abrupt("return",c);case 59:if(e.prev=59,e.t1=e.catch(31),!(e.t1 instanceof EvalError)){e.next=63;break}throw new Error("error while parsing frame ".concat(I,' "').concat(e.t1.message,'"'));case 63:throw e.t1;case 64:case"end":return e.stop()}}),e,null,[[31,59],[38,50,53,56]])})))).apply(this,arguments)}function B(e){var t,a=e.context,r=e.radius,n=e.particle,i=e.delta,o=n.image;if(null!==o&&void 0!==o&&o.gifData&&o.gif){var s,c=new OffscreenCanvas(o.gifData.width,o.gifData.height),l=c.getContext("2d");if(!l)throw new Error("could not create offscreen canvas context");if(l.imageSmoothingQuality="low",l.imageSmoothingEnabled=!1,l.clearRect(h.x,h.y,c.width,c.height),void 0===n.gifLoopCount)n.gifLoopCount=null!==(s=o.gifLoopCount)&&void 0!==s?s:m;var u=null!==(t=n.gifFrame)&&void 0!==t?t:f,x={x:-o.gifData.width*g,y:-o.gifData.height*g},w=o.gifData.frames[u];if(void 0===n.gifTime&&(n.gifTime=p),w.bitmap){switch(a.scale(r/o.gifData.width,r/o.gifData.height),w.disposalMethod){case 4:case 5:case 6:case 7:case 0:l.drawImage(w.bitmap,w.left,w.top),a.drawImage(c,x.x,x.y),l.clearRect(h.x,h.y,c.width,c.height);break;case 1:l.drawImage(w.bitmap,w.left,w.top),a.drawImage(c,x.x,x.y);break;case 2:l.drawImage(w.bitmap,w.left,w.top),a.drawImage(c,x.x,x.y),l.clearRect(h.x,h.y,c.width,c.height),o.gifData.globalColorTable.length?l.putImageData(o.gifData.backgroundImage,x.x,x.y):l.putImageData(o.gifData.frames[d].image,x.x+w.left,x.y+w.top);break;case 3:var b=l.getImageData(h.x,h.y,c.width,c.height);l.drawImage(w.bitmap,w.left,w.top),a.drawImage(c,x.x,x.y),l.clearRect(h.x,h.y,c.width,c.height),l.putImageData(b,h.x,h.y)}if(n.gifTime+=i.value,n.gifTime>w.delayTime){if(n.gifTime-=w.delayTime,++u>=o.gifData.frames.length){if(--n.gifLoopCount<=m)return;u=d,l.clearRect(h.x,h.y,c.width,c.height)}n.gifFrame=u}a.scale(o.gifData.width/r,o.gifData.height/r)}}}function D(e){return Z.apply(this,arguments)}function Z(){return(Z=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("gif"===t.type){e.next=8;break}return e.next=3,Promise.resolve().then(a.bind(a,9602));case 3:return n=e.sent,i=n.loadImage,e.next=7,i(t);case 7:return e.abrupt("return");case 8:return t.loading=!0,e.prev=9,e.next=12,C(t.source);case 12:t.gifData=e.sent,t.gifLoopCount=null!==(o=I(t.gifData))&&void 0!==o?o:m,t.gifLoopCount||(t.gifLoopCount=1/0),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(9),t.error=!0;case 20:t.loading=!1;case 21:case"end":return e.stop()}}),e,null,[[9,17]])})))).apply(this,arguments)}},2847:function(e,t,a){a.r(t),a.d(t,{ImageDrawer:function(){return h}});var r=a(7762),n=a(4165),i=a(5861),o=a(5671),s=a(3144),c=a(4709),l=a(9602),u=a(9188),h=function(){function e(t){var a=this;(0,o.Z)(this,e),this.loadImageShape=function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a._engine.loadImage){e.next=2;break}throw new Error("".concat(c.gK," image shape not initialized"));case 2:return e.next=4,a._engine.loadImage({gif:t.gif,name:t.name,replaceColor:null!==(r=t.replaceColor)&&void 0!==r&&r,src:t.src});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this._engine=t}return(0,s.Z)(e,[{key:"addImage",value:function(e){this._engine.images||(this._engine.images=[]),this._engine.images.push(e)}},{key:"draw",value:function(e){var t=e.context,a=e.radius,r=e.particle,n=e.opacity,i=r.image,o=null===i||void 0===i?void 0:i.element;if(i){if(t.globalAlpha=n,i.gif&&i.gifData)(0,u.drawGif)(e);else if(o){var s=i.ratio,c={x:-a,y:-a},l=2*a;t.drawImage(o,c.x,c.y,l,l/s)}t.globalAlpha=1}}},{key:"getSidesCount",value:function(){return 12}},{key:"init",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var a,i,o,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=t.actualOptions).preload&&this._engine.loadImage){e.next=3;break}return e.abrupt("return");case 3:i=(0,r.Z)(a.preload),e.prev=4,i.s();case 6:if((o=i.n()).done){e.next=12;break}return s=o.value,e.next=10,this._engine.loadImage(s);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),i.e(e.t0);case 17:return e.prev=17,i.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[4,14,17,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"loadShape",value:function(e){var t=this;if("image"===e.shape||"images"===e.shape){this._engine.images||(this._engine.images=[]);var a=e.shapeData;if(a)this._engine.images.find((function(e){return e.name===a.name||e.source===a.src}))||this.loadImageShape(a).then((function(){t.loadShape(e)}))}}},{key:"particleInit",value:function(e,t){var a,r=this;if("image"===t.shape||"images"===t.shape){this._engine.images||(this._engine.images=[]);var o=this._engine.images,s=t.shapeData;if(s){var c=t.getFillColor(),u=o.find((function(e){return e.name===s.name||e.source===s.src}));if(u){var h=null!==(a=s.replaceColor)&&void 0!==a?a:u.replaceColor;u.loading?setTimeout((function(){r.particleInit(e,t)})):(0,i.Z)((0,n.Z)().mark((function e(){var a,r,i,o,f,g,p;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u.svgData||!c){e.next=6;break}return e.next=3,(0,l.replaceImageColor)(u,s,c,t);case 3:i=e.sent,e.next=7;break;case 6:i={color:c,data:u,element:u.element,gif:u.gif,gifData:u.gifData,gifLoopCount:u.gifLoopCount,loaded:!0,ratio:s.width&&s.height?s.width/s.height:null!==(o=u.ratio)&&void 0!==o?o:1,replaceColor:h,source:s.src};case 7:i.ratio||(i.ratio=1),f=null!==(a=s.fill)&&void 0!==a?a:t.shapeFill,g=null!==(r=s.close)&&void 0!==r?r:t.shapeClose,p={image:i,fill:f,close:g},t.image=p.image,t.shapeFill=p.fill,t.shapeClose=p.close;case 12:case"end":return e.stop()}}),e)})))()}}}}}]),e}()}}]);
//# sourceMappingURL=2847.686e34cf.chunk.js.map